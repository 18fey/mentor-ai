// app/legal/confirm/page.tsx
"use client";

import { useState } from "react";
import { useRouter, useSearchParams } from "next/navigation";

const TERMS_VERSION = "2025-12-02";

// ここに送ってくれた原稿をそのままプレーンテキストで入れているよ
const TERMS_TEXT: string = `
Mentor.AI 利用規約
制定日：2025年11月25日
最終更新日：2025年12月10日（ドラフト）

本利用規約（以下「本規約」といいます）は、Mentor.AIの運営者である渡邉花鈴（事業所：東京都中央区銀座一丁目22番11号 銀座大竹ビジデンス 2F。以下「当社」といいます）が提供するAI就活支援サービス「Mentor.AI」（理由の如何を問わずサービスの名称または内容が変更された場合には、当該変更後のサービスを含み、以下「本サービス」といいます）の利用条件を定めるものです。個人として本サービスを利用する者（以下「ユーザー」といいます）は、本規約に同意したうえで本サービスを利用するものとします。

第1条（適用範囲）
1　本規約は、本サービスの提供条件および本サービスの利用に関わる当社とユーザーとの一切の関係に適用されます。  
2　当社が本サービスに関して別途定めるガイドライン、注意事項、ヘルプページ等（「返金ポリシー（Metaコイン）」を含みます）は、本規約の一部を構成するものとします。  

第2条（定義）
本規約において使用する以下の用語は各々以下に定める意味を有するものとします。
　(1) 「外部AIモデル」とは、第6条第1項において定義された「外部AIモデル」を意味します。
　(2) 「知的財産権」とは、著作権、特許権、実用新案権、商標権、意匠権その他の知的財産権（それらの権利を取得し、またはそれらの権利につき登録等を出願する権利を含みます）を意味します。
　(3) 「当社ウェブサイト」とは、そのドメインが「mentor-ai.net」である当社が運営するウェブサイト（理由の如何を問わず当社のウェブサイトのドメインまたは内容が変更された場合は、当該変更後のウェブサイトを含みます）を意味します。
　(4) 「反社会的勢力等」とは、暴力団、暴力団員、暴力団準構成員、暴力団員または暴力団準構成員でなくなった日から5年を経過しない者、暴力団関係企業、総会屋、社会運動等標ぼうゴロ、特殊知能暴力集団その他暴力、威力または詐欺的手法を使用して経済的利益を追求する集団または個人を意味します。

第3条（サービス概要）
1　本サービスは、主として学生等の個人ユーザーを対象とした、AIを活用した就活支援サービスです。主な機能は以下のとおりです。  
　(1) AI思考タイプ診断（16タイプ分類など）  
　(2) 志望業界との相性診断・ギャップ分析  
　(3) エントリーシート（ES）等の文章添削支援  
　(4) 一般面接・ケース面接等の想定質問生成・回答作成支援  
　(5) そのほか当社が定める機能  
2　本サービスの具体的な機能・料金・提供条件等は、当社ウェブサイトまたは本サービス上に表示するものとします。

第4条（利用登録）
1　本サービスの利用を希望する者（以下「申請者」といいます）は、本規約に同意の上、当社所定の方法により本サービスの利用の登録（以下「利用登録」といいます）の申請を行うものとします。  
2　当社は、申請者が次の各号のいずれかに該当すると判断した場合、利用登録を承認しないことがあります。この場合、当社はその理由を開示する義務を負いません。  
　(1) 利用登録の申請時に当社に対し虚偽の情報を提供し、または誤記もしくは記載漏れがあったことが判明した場合  
　(2) 過去に本サービスを含む当社のサービスの利用停止等の措置を受けた者である場合  
　(3) 反社会的勢力等またはこれに準ずる者であると当社が判断した場合  
　(4) 未成年者または法人である場合
　(5) 外国の居住者である場合
　(6) その他、当社が利用登録を適当でないと判断した場合  
3　当社が申請者に対し、第1項に基づく利用登録の申請を承諾する旨を当社所定の方法により通知をしたことをもって、当社と当該申請者との間に本規約の諸規定に従った本サービスの利用にかかる契約（以下「利用契約」といいます）が成立するものとし、当社は、利用契約の締結後速やかに、当該申請者に対しアカウントを付与するものとします。
4　ユーザーは、利用登録の申請時に当社に対し提供した情報（当該情報が既に変更されている場合にあっては、変更後の情報を含みます）に変更があった場合は、遅滞なく、当社の定める方法により、当該変更事項を当社に通知し、当社から要求された資料を提出するものとします。

第5条（アカウント管理）

1　ユーザーは、自己の責任において、本サービスのログイン情報（ユーザーのメールアドレス・パスワードその他の本サービスの利用にあたり当社のウェブサイトにログインするために必要となる情報を意味します。以下同じ）を適切に管理するものとします。  
2　ログイン情報の管理不十分、使用上の過誤、第三者による不正利用等によりユーザーに損害が生じた場合であっても、当社は故意または過失がない限り一切の責任を負いません。  
3　ユーザーは、ログイン情報を第三者に譲渡、貸与、共有してはならないものとします。

第6条（AI利用に関する特則）
1　本サービスは、OpenAI API（GPT-4.1等）その他の当社以外の事業者が提供する生成AIを用いたサービス（以下「外部AIモデル」といいます）を利用して動作します。  
2　ユーザーは、本サービスに入力した情報の一部が、当社により本サービスの提供のために利用され、また、外部AIモデルの提供企業に送信される場合があることに同意するものとします。  
3　本サービスにおける外部AIモデルの利用により出力されるコンテンツは、統計的予測に基づくものであり、その正確性、完全性、有用性、特定目的への適合性について、当社は一切保証しません。  
4　本サービスにおける診断結果、フィードバック、アドバイス等は、就職活動・転職活動・キャリア形成に関する参考情報に過ぎず、最終的な判断はユーザー自身の責任において行うものとします。  
5　本サービスの結果は、医学的診断、専門家によるカウンセリング、人格評価等を代替するものではありません。
6　本サービスは、選考合否等の結果を保証する性質のものではありません。


第7条（利用料金・Metaコイン）
1　本サービスには、無料で利用できる当社所定の機能および有料でのみ利用できる当社所定の機能（以下「有料機能」といいます）があります。有料機能は、当社が本サービス上で販売するデジタルコイン「Meta」（理由の如何を問わずデジタルコインの名称または内容が変更された場合には、当該変更後のデジタルコインを含み、以下「Metaコイン」といいます）を消費することその他の当社所定の決済手段により利用可能となります。  
2　Metaコインの販売単位、価格その他の条件は、本サービス上の表示に従うものとします。また、Metaコインに関する取り決めは、本規約に定めるほか、当社が別途定めるポリシーに従うものとします。  
3　ユーザーは、当社が指定する決済方法（クレジットカード決済（Stripeその他の当社所定のサービスを含みます））により、Metaコインの代金その他の有料機能の利用料金を支払うものとします。  
4　Metaコインの有効期間は、Metaコインを購入した日から180日間とし、ユーザーは、有効期間を経過したMetaコインを消費して有料機能を利用することはできないものとします。
5　Metaコインは、先に購入したものから順に消費されるものとします。
6　Metaコインは、法令により義務付けられる場合または当社が別途定める返金ポリシーに定める場合を除き、原則として返金不可とし、ユーザーの都合によるMetaコインの購入のキャンセルおよびMetaコインの払い戻しには応じません。
7 利用契約が終了した場合、当該終了時点でユーザーが保有するMetaコインは失効し、ユーザーは当該Metaコインの払い戻しを受けられないものとします。また、当該ユーザーが再度当社と利用契約を締結した場合でも、当該Metaコインは復活せず、利用できないものとします。
8　将来サブスクリプションプラン等を提供する場合には、その内容・料金・解約条件等を別途定め、本サービス上に表示します。

第8条（禁止事項）
ユーザーは、本サービスの利用に際して、以下の行為をしてはならないものとします。  
(1) 法令または公序良俗に違反する行為  
(2) 虚偽または不正確な情報を登録・送信する行為  
(3) 他のユーザーまたは第三者になりすます行為  
(4) 本サービスを営利目的その他の不正な目的で利用する行為  
(5) 当社または第三者の知的財産権、プライバシー権、その他の権利・利益を侵害する行為  
(6) 本サービスのサーバーまたはネットワークに過度な負荷をかける行為  
(7) 本サービスのリバースエンジニアリング、解析その他これに類する行為  
(8) 外部AIモデルを用いて、差別的・侮辱的・違法なコンテンツを出力し、または拡散する行為  
(9) 本サービスで提供される診断結果、スコア、フィードバックその他の情報およびデータ等を、当社の許可なく転載・配布・販売する行為  
(10) 外部AIモデルの提供者が利用規約、ポリシー、ガイドラインその他のルールにより禁止する行為
(11) 本サービスにより出力される情報を用いて第三者を誤解させる行為、虚偽情報の流布、名誉毀損等の行為
(12) 本サービスを大量処理・スクレイピング等により不正に利用する行為
(13) コンピューター・ウィルスその他の有害なコンピューター・プログラムを含む情報を送信する行為
(14) 当社による本サービスの運営を妨害するおそれのあると合理的に認められる行為
(15)その他、当社が不適切と合理的に判断する行為

第9条（サービスの変更・中断・終了）
1　当社は、ユーザーへの事前の通知なく、本サービスの内容の全部または一部を変更することができます。  
2　当社は、システム保守、障害対応、外部サービスの停止等のやむを得ない事情により、ユーザーに事前に通知することなく、本サービスの提供を一時的に中断することがあります。  
3　当社は、合理的な範囲でユーザーに事前に通知したうえで、本サービスの提供を終了することができます。本サービスの提供を終了した場合、当社とユーザーとの利用契約は将来に向かって当然に効力を失うものとします。
4　当社は、本条に基づき当社が行った行為によりユーザーに生じた損害について、当社の故意または過失による場合を除き、一切の責任を負いません。

第10条（免責事項）
1　当社は、本サービスがユーザーの就職活動・転職活動・人事評価等において特定の結果（内定獲得、選考通過等）を保証するものではありません。  
2　当社は、本サービスに事実上または法律上の瑕疵（安全性、信頼性、正確性、完全性、有効性、特定目的適合性、セキュリティなど）がないことを保証しません。  
3　当社がユーザーに対して損害賠償責任を負う場合であっても、その責任は、当社に故意または重過失がある場合を除き、直接かつ通常の損害に限り、逸失利益、間接損害等は含まないものとし、また、当該ユーザーが過去12か月間に当社に支払った利用料金（Metaコインの購入代金を含みます）の総額（かかる利用料金が500円に満たない場合は500円）を上限とします。  
4　外部AIモデルの仕様変更・障害・提供停止その他当社の合理的支配を超える事由により生じた損害について、当社に故意または過失がある場合を除き、当社は責任を負いません。

第11条（権利帰属）
1　本サービスおよび本サービスの利用により提供される診断結果、スコア、フィードバック等に関する知的財産権は全て当社または当社にライセンスを許諾している者に帰属します。
2　ユーザーは、本サービスの利用により提供される診断結果、スコア、フィードバック等を本規約その他当社が定める一切の条件、規約等に抵触しない限りで、自己使用目的で自由に利用することができます。ただし、第三者に対し再利用を許諾することはできないものとします。

第12条（利用停止・利用契約の解除）
1　当社は、以下の場合に、事前通知なく、アカウントの利用停止、利用契約の解除等の措置を行うことができます。
　(1) 本規約に違反した場合
　(2) 第4条第2項各号のいずれかに該当することが判明した場合
　(3) 6か月以上本サービスの利用がなく、当社からの連絡に対して応答がない場合
　(4) AI出力・Metaコイン等の不正利用が合理的に疑われる場合
　(5) その他、当社がサービス運営上やむを得ないと合理的に判断した場合
2　ユーザーは、当社所定の方法により、いつでも利用契約を解約することができます。ただし、解約前に支払われた利用料金・Metaコイン代金の返金は行われません。
3　本条に基づく利用契約の解除または解約は、将来に向かってのみ効力を生じるものとします。
4　当社は、本条に基づき当社が行った行為によりユーザーに生じた損害について、当社の故意または過失による場合を除き、一切の責任を負いません。

第13条（個人情報の取扱い）
当社によるユーザーの個人情報（個人情報の保護に関する法律第2条第1項に定める「個人情報」を意味します）の取扱いについては、別途定める当社のプライバシーポリシーの定めによるものとし、ユーザーはこのプライバシーポリシーに従って当社がユーザーの個人情報を取扱うことについて同意するものとします。

第14条（規約の変更）
1　当社は、必要と認める場合、本規約を変更することができます。当社が本規約を変更する場合、当社は本サービス上での掲示その他当社が適切と判断する方法により、変更の内容および変更の効力発生時期を、当該効力発生時期までに告知するものとします。
2　法令上ユーザーの同意が必要な変更を行う場合、当社は本サービス上での掲示その他当社が適切と判断する方法により告知するとともに、当社所定の方法でユーザーの同意を得るものとします。  
3　ユーザーが本規約変更後に本サービスを利用した場合には、変更後の本規約に同意したものとみなします。

第15条（権利義務の譲渡等）
1　ユーザーは、当社の書面による事前の承諾なく、利用契約上の地位または本規約に基づく権利もしくは義務につき、第三者に対し、譲渡、移転、担保設定、その他の処分をすることはできません。
2　当社は本サービスにかかる事業を第三者に譲渡（事業譲渡、会社分割その他態様の如何を問わないものとします）した場合には、当該譲渡に伴い利用契約上の地位、本規約に基づく権利および義務ならびにユーザーが当社に対し提供した情報その他の顧客情報を当該譲渡の譲受人に譲渡することができるものとし、ユーザーは、かかる譲渡につき本項において予め同意したものとします。

第16条（準拠法・管轄）
本規約の解釈・適用には日本法を準拠法とし、本サービスに関連して当社とユーザーとの間で紛争が生じた場合には、当社所在地を管轄する日本の裁判所を第一審の専属的合意管轄裁判所とします。

`;

const PRIVACY_TEXT: string = `
Mentor.AI プライバシーポリシー
制定日：2025年11月25日
最終更新日：2025年12月10日（ドラフト）

AI就活支援サービス「Mentor.AI」（以下「本サービス」といいます）の運営者（以下「当社」といいます）は、本サービスにおいて取り扱う個人情報その他のユーザーの個人情報の保護を重要な責務と認識し、以下のとおりプライバシーポリシー（以下「本ポリシー」といいます）を定めます。なお、本ポリシーに別段の定義がない用語は、当社の公表する「Mentor.AI 利用規約」または個人情報保護法に定めるところによるものとします。

第1条（適用範囲）
1　本ポリシーは、当社が取得・利用する全ての個人情報（個人情報保護法第2条第1項により定義される「個人情報」を意味します）に適用されます。
2　本サービスは、日本国内在住の個人ユーザー向けに提供されるサービスを前提としています。
3　本サービスからリンクされる当社以外の事業者が提供するサービス（SNS、外部AIモデル等）における情報の取扱いについては、当該事業者が定める個人情報の取扱いに関する規程が適用されます。

第2条（取得する情報）
当社は、本サービスの提供にあたり、次の情報を取得することがあります。

1　ユーザー（本サービスの利用者および本サービスを利用しようとする者を意味します。以下同じ）が、本サービスを通じて直接入力しまたは当社に提供する情報のうち、次の各号のいずれかに該当する情報  
(1) 氏名（またはニックネーム）  
(2) メールアドレス  
(3) 大学名、学部・学科、学年その他のプロフィール情報  
(4) 志望業界、志望企業、興味関心タグ等のキャリア情報  
(5) AI思考タイプ診断、その他の診断・アンケートへの回答内容  
(6) ES添削、面接練習、ケース問題等で入力されたテキスト内容  
(7) お問い合わせ時にユーザーが任意で提供する情報  
(8) その他当社がユーザーの同意に基づき取得する情報

2　利用状況に関する情報で、次の各号のいずれかに該当する情報  
(1) ログイン日時、利用した機能、診断スコア、フィードバック履歴等の利用履歴  
(2) IPアドレス、ブラウザ情報、OS・端末情報、Cookie情報、リファラ等の技術情報  
(3) エラーログ等、本サービスの安定運用のために必要な情報  

3　決済に関する情報  
有料機能の利用にあたって、当社は決済代行事業者（Stripe等）を通じて決済を行います。当社は、クレジットカード番号等のセンシティブな決済情報そのものを直接取得せず、決済代行事業者から提供されるトークン情報や取引情報の範囲でこれを取得することがあります。

第3条（利用目的）
当社は、取得した個人情報を以下の目的のために利用します。

(1) 本サービスの提供・運営・維持・改善のため  
(2) 本人に対し、本サービス上でAI診断結果、レポート、フィードバック、アドバイス等を生成・表示するため  
(3) 外部AIモデル（OpenAI API等）を利用した回答生成・解析処理を行うため  
(4) 本人に対して本サービスに関するお知らせ、重要な通知、機能追加・変更等の案内を行うため  
(5) ユーザーからの問い合わせ・相談への対応のため  
(6) 本サービスの利用状況の分析、統計データ・匿名加工情報の作成および作成した統計データおよび匿名加工情報の第三者への提供のため  
(7) 不正アクセス・不正利用の検知、防止その他セキュリティ確保のため  
(8) 法令、利用規約等に基づき、または行政機関・裁判所等の要請に応じて必要な対応を行うため  
(9) AIモデル改善のための統計処理のため。ただし、個人を識別できる形での学習利用は行いません。
(10) その他、上記利用目的に付随する目的のため

第4条（外部AIモデルの利用）
1　本サービスは、OpenAI API（GPT-4.1等）その他の外部AIモデルを利用して動作します。  
2　当社は、診断やフィードバック等の生成に必要な最小限の情報のみを外部AIモデルに送信するよう配慮します。  
3　本サービスにおいて外部AIモデルを利用する場合であっても、当社は、APIを通じて送信されたデータが、外部AIモデルの提供者によるモデルの再学習には利用されない設定としています。  
4　当社は、ユーザーが本サービスに入力したテキスト、診断結果等のデータを、個人が特定されない統計情報として本サービスの改善に利用することがありますが、外部AIモデルの再学習目的で利用することはありません。

第5条（第三者提供）
1　当社は、次の各号のいずれかに該当する場合を除き、個人情報を第三者に提供しません。  
(1) 本人の同意がある場合  
(2) 法令に基づく場合  
(3) 人の生命・身体・財産の保護のために必要であり、本人の同意取得が困難な場合  
(4) 公衆衛生の向上または児童の健全な育成の推進のために特に必要な場合であって、本人の同意取得が困難な場合  
(5) 国の機関もしくは地方公共団体又はその委託を受けた者が法令の定める事務を遂行することに対して協力する必要がある場合であって、本人の同意取得により当該事務の遂行に支障を及ぼすおそれがある場合
(6) 学術研究機関等に個人データを提供する場合であって、当該学術研究機関等が当該個人データを学術研究目的で取り扱う必要があるとき（当該個人データを取り扱う目的の一部が学術研究目的である場合を含み、個人の権利利益を不当に侵害するおそれがある場合を除く。） 
2　次に掲げる場合は、第1項に定める第三者への個人情報の提供には該当しません。
(1) 利用目的の達成に必要な範囲内において個人情報の取扱いの全部または一部を委託することに伴って個人情報を提供する場合
(2) 合併その他の事由による事業の承継に伴って個人情報が提供される場合
(3) 個人情報保護法の定めに基づき共同利用する場合

第6条（個人情報の取扱いの委託）
当社は、本サービスの運営その他の利用目的の達成に必要な範囲で、個人情報の取扱いを他の事業者に委託することがあり、それに伴って個人情報を当該他の事業者に提供することがあります。この場合、当社は、当該他の事業者に対して個人情報の適切な安全管理措置を求め、必要な監督を行います。

第7条（データの保存期間）
1　ユーザーのアカウント情報および利用履歴は、当該ユーザーがアカウントを保有している期間中、当社の定める範囲で保存されます。  
2　当社とユーザーとの間の利用契約が終了した場合、当社は、法令上の保存義務があるもの等を除き、相当の期間経過後に、当該ユーザーに関する個人情報を当社の定める方法により削除または匿名化します。  
3　ログデータおよび技術情報については、セキュリティ対策および障害対応等のために一定期間保存した後、削除または匿名化します。

第8条（匿名加工情報の取扱い）
1　当社は、匿名加工情報（個人情報保護法第2条第6項に定めるものを意味し、同法第16条第6項に定める匿名加工情報データベース等を構成するものに限ります。以下同じ）を作成するときは、個人情報保護委員会規則で定める基準に従い、個人情報を加工するものとします。
2　当社は、匿名加工情報を作成したときは、個人情報保護委員会規則で定める基準に従い、安全管理のための措置を講じます。
3　当社は、匿名加工情報を作成したときは、個人情報保護委員会規則で定めるところにより、当該匿名加工情報に含まれる個人に関する情報の項目を公表します。なお、既に作成している匿名加工情報に関する情報の項目は、以下に記載のとおりです。また、当社は継続的な匿名加工情報の作成を予定しており、かかる情報の項目は、当社が異なる内容を公表する場合を除き、今後作成する匿名加工情報にもあてはまるものとします。

【項目】
・年齢、生年月日、性別等の身体情報
・商品購入日時、本サービスの利用期間、本サービスの利用履歴
・大学名、学部・学科、学年その他のプロフィール情報
・志望業界、志望企業、興味関心タグ等のキャリア情報

4　当社は、匿名加工情報（当社が作成したものおよび第三者から提供を受けたものを含みます。以下別段の定めがない限り同様とします）を第三者に提供するときは、個人情報保護委員会規則で定めるところにより、あらかじめ、第三者に提供される匿名加工情報に含まれる個人に関する情報の項目およびその提供の方法について公表するとともに、当該第三者に対して、当該提供に係る情報が匿名加工情報である旨を明示します。

第9条（Cookie等の利用）
1　本サービスでは、ユーザーの利便性向上、アクセス解析、セキュリティ確保等のために、Cookieその他の類似技術を利用することがあります。  
2　ユーザーは、ブラウザの設定によりCookieの保存を制限または拒否することができますが、その場合、本サービスの一部機能が利用できないことがあります。

第10条（保有個人データの開示・訂正・利用停止等）
１　ユーザーは、個人情報保護法の定めに基づき、当社が保有する自己の個人情報について、開示・訂正・追加・削除・利用停止・第三者提供の停止・第三者提供にかかる記録の開示・利用目的の通知等を求めることができます。これらの請求を行う場合は、第12条に定めるお問い合わせ窓口までご連絡ください。なお、法令に基づき当社が請求に応じる義務を負わない場合には、請求に応じられないことがあります。また、ユーザーは、当該請求を行う場合、当社が求める本人確認に必要な情報または資料等を当社に提供することを要するものとします。
2　第1項に基づく利用目的の通知、または個人情報もしくは第三者提供記録の開示につきましては、手数料（1件あたり700円） を頂戴しておりますので、あらかじめ御了承ください。

第11条（安全管理措置）
当社は、個人情報の漏えい、滅失またはき損の防止その他個人情報の安全管理のため、アクセス制御、暗号化、ログ管理等、必要かつ適切な安全管理措置を講じます。当社が講じる安全管理措置の具体的な内容については、本ポリシーに記載の当社のお問い合わせ窓口にお問い合わせください。

第12条（本ポリシーの変更）
1　当社は、必要に応じて本ポリシーを変更することがあります。  
2　重要な変更を行う場合には、本サービス上での掲示その他当社が適切と判断する方法により周知します。  

第13条（お問い合わせ窓口）
本サービスおよび当社による個人情報の取扱いに関するご意見、ご質問、苦情の申出その他の事項に関するお問い合わせは、以下の窓口までご連絡ください。 
メールアドレス：support@mentor-ai.net

当社の氏名または名称および住所については、上記お問い合わせ窓口に請求があった場合に、遅滞なく提供します。
`;

export default function LegalConfirmPage() {
  const router = useRouter();
  const sp = useSearchParams();

  const nextRaw = sp.get("next") || "/onboarding";
  const next = nextRaw.startsWith("/") ? nextRaw : "/onboarding";

  const [isAdult, setIsAdult] = useState(false);
  const [agreed, setAgreed] = useState(false);
  const [loading, setLoading] = useState(false);
  const [err, setErr] = useState<string | null>(null);

  const canSubmit = isAdult && agreed && !loading;

  const submit = async () => {
    if (!canSubmit) return;
    setErr(null);
    setLoading(true);

    try {
      const res = await fetch("/api/accept-terms", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          is_adult: isAdult,
          terms_version: TERMS_VERSION,
        }),
      });

      if (!res.ok) {
        const t = await res.text();
        throw new Error(t || "accept-terms failed");
      }

      router.replace(next);
    } catch (e) {
      setErr("同意の保存に失敗しました。もう一度お試しください。");
      console.error(e);
    } finally {
      setLoading(false);
    }
  };

  return (
    <main className="min-h-screen bg-slate-950 px-6 py-10 text-slate-100">
      <div className="mx-auto max-w-2xl rounded-3xl bg-slate-900/70 p-6 shadow-[0_18px_45px_rgba(15,23,42,0.5)] backdrop-blur-[26px]">
        <h1 className="text-lg font-semibold">利用規約・年齢確認</h1>
        <p className="mt-2 text-xs text-slate-300">
          サービスを利用する前に、利用規約・プライバシーポリシーへの同意と年齢確認が必要です。
        </p>

        {err && (
          <p className="mt-4 rounded-2xl bg-rose-500/15 px-4 py-2 text-xs text-rose-200">
            {err}
          </p>
        )}

        <div className="mt-6 space-y-3">
          <label className="flex items-start gap-2 text-xs text-slate-300">
            <input
              type="checkbox"
              checked={isAdult}
              onChange={(e) => setIsAdult(e.target.checked)}
              className="mt-1 h-4 w-4"
            />
            <span>私は18歳以上です</span>
          </label>

          <label className="flex items-start gap-2 text-xs text-slate-300">
            <input
              type="checkbox"
              checked={agreed}
              onChange={(e) => setAgreed(e.target.checked)}
              className="mt-1 h-4 w-4"
            />
            <span>
              利用規約とプライバシーポリシーに同意します
              <span className="ml-2 text-[11px] text-slate-400">
                （別タブで開いて確認できるUIにしてもOK）
              </span>
            </span>
          </label>
        </div>

        <details className="mt-6 rounded-2xl bg-slate-950/40 p-4">
          <summary className="cursor-pointer text-xs text-slate-200">利用規約（全文）</summary>
          <div className="mt-3 whitespace-pre-wrap text-[11px] leading-relaxed text-slate-300">
            {TERMS_TEXT}
          </div>
        </details>

        <details className="mt-3 rounded-2xl bg-slate-950/40 p-4">
          <summary className="cursor-pointer text-xs text-slate-200">
            プライバシーポリシー（全文）
          </summary>
          <div className="mt-3 whitespace-pre-wrap text-[11px] leading-relaxed text-slate-300">
            {PRIVACY_TEXT}
          </div>
        </details>

        <button
          onClick={submit}
          disabled={!canSubmit}
          className="mt-6 w-full rounded-2xl bg-sky-500 px-4 py-2 text-sm font-semibold text-white disabled:opacity-60"
        >
          {loading ? "保存中..." : "同意して続行"}
        </button>

        <p className="mt-3 text-center text-[11px] text-slate-400">
          同意の記録：terms_version = {TERMS_VERSION}
        </p>
      </div>
    </main>
  );
}
